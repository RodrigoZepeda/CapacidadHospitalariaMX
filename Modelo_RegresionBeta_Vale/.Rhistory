rstan:::rstudio_stanc("~/GitHub/CapacidadHospitalariaMX/Modelo_RegresionBeta_Vale/Modelo1.stan")
rstan:::rstudio_stanc("~/GitHub/CapacidadHospitalariaMX/Modelo_RegresionBeta_Vale/Modelo1.stan")
rstan:::rstudio_stanc("~/GitHub/CapacidadHospitalariaMX/Modelo_RegresionBeta_Vale/Modelo1.stan")
rstan:::rstudio_stanc("~/GitHub/CapacidadHospitalariaMX/Modelo_RegresionBeta_Vale/Modelo1.stan")
rm(list = ls())
library(readr)
library(tidyverse)
#library(cmdstanr)
library(lubridate)
library(dplyr)
#-------------------- Lectura y seleccion de Datos -------------------
dir <- "C:/Users/Valeria/Documents/GitHub/CapacidadHospitalariaMX/Modelo_RegresionBeta_Vale"
stan_fname <- "Modelo1.stan"
setwd(dir)
#Lectura de la base de datos
hospitalizaciones<- readRDS("HospitalizacionesMX.rds")
#Cambio los nombres de las columnas para que no tengan acentos
colnames(hospitalizaciones)<-c("Unidad_medica", "Estado", "Institucion", "CLUES",
"Hospitalizados", "Ventilacion", "UCI_y_Ventilacion", "Fecha")
#Hago una copia de hospitalizaciones
muestra_Grande <- hospitalizaciones
#la conversión a factores se hace por orden alfabetico
muestra_Grande <- hospitalizaciones %>%
mutate(Fecha = as.Date(Fecha)) %>%                          #convertimos fecha a tipo fecha
mutate(Estado = as.numeric(factor(Estado))) %>%             #convertimos Estado en numeros del 1 al 32
mutate(Institucion = as.numeric(factor(Institucion)))       #convertimos institucion en numeros del 1 al 12
#Voy a agarrar solo un pequeño sample
set.set(99)
#Hago una sample donde me filtre por 2 estados y solo 2 instituciones
sample <- muestra_Grande %>%
filter(Estado == 1 | Estado == 2) %>% #Filtramos por estado como prueba
filter(Institucion == 3 | Institucion == 4) #Filtramos por institucion
matriz_P <- sample %>%
group_by(Unidad_medica)  %>% #acomodamos por unidad médica
summarise(Fecha, Estado, Institucion) # %>% #vemos las fechas, estado, instituciones
